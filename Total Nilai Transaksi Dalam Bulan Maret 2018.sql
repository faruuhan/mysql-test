SELECT invoice.id AS invoice_id , sum(product.price * invoice_detail.quantity) total_price , invoice.date AS transaction_date FROM invoice INNER JOIN invoice_detail ON invoice.id = invoice_detail.invoice_id INNER JOIN product ON product.id = invoice_detail.product_id WHERE (invoice.date >= '2018-03-01' AND invoice.date <= '2018-03-31' AND invoice.`status` = 'PAY' ) GROUP BY invoice.id